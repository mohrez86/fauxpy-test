# Testing Various Versions

All testing takes place within this directory.

## The Big Picture

Here’s a high-level overview of the
testing process: 

For each version of
FauxPy, there is a dedicated directory
named according to the version,
such as 
`v[major version]_[minor version]`.
For example, FauxPy version 0.1
is located in the `v_0_1` directory.

Within each version directory, 
you will find the source code for
that specific version of FauxPy
along with scripts designed to run
FauxPy with real-world programs.
These scripts are identical to 
those generated in the 
[bash_script_generator](../bash_script_generator) 
directory.

We have defined three testing scenarios
for each version
(currently, only Tiny has been configured):

- **Tiny**: Expected to complete in
less than 5 hours on a personal laptop.
- **Small**: Must include at least one
subject from the list of 
projects provided in
the root [README.md](../README.md) 
file and is expected to finish
within 24 hours on a personal laptop.
- **Large**: Designed to run all 
scripts in the 
[scripts](../bash_script_generator/scripts) 
directory.

For each testing scenario, there 
is a corresponding directory 
named 
`scripts_[test scenario name]`. 
For example, the directory for 
the tiny test scenario is 
`scripts_tiny` (located at 
`v_0_1/scripts_tiny`). 
Additionally, each testing scenario 
has a bash script named
`run_[test scenario name]_scripts.sh` 
that executes all the scripts
for that specific test scenario.

After running all the scripts for
a given test scenario, we extract features
from the output generated by FauxPy. 
We follow the same procedure for the
previous version of FauxPy.

We then compare these features between
two different versions to 
ensure consistency. 
Any discrepancies may indicate
potential issues that need 
further investigation.

At present, we focus on two
specific features: 
*Generalized E_Inspect* 
and *Output Length*. 
These features are two
fault localization 
evaluation metrics
described in
the paper
["An Empirical Study
of Fault Localization 
in Python Programs"](https://doi.org/10.1007/s10664-024-10475-3)
by Mohammad Rezaalipour 
and Carlo A. Furia.
We plan to incorporate 
additional features in 
the future to enable more
comprehensive testing.

## Required Set up

The scripts for running FauxPy are 
designed to work with projects from
BugsInPy, so you need to configure
your machine accordingly.

BugsInPy requires three specific
Python versions (3.6, 3.7, and 3.8)
because different projects within 
this framework rely on 
these versions. It's recommended 
to use Python virtual environments for 
each of these Python versions.

This is because BugsInPy does not
recognize Python commands like
`python3.6` or `python3.7`. 
Instead, it relies on the `python3`
command. The BugsInPy shell script
that compiles a project—creating a
virtual environment and installing all
necessary dependencies—uses
the 
`python3` command for environment
creation, as detailed 
[here](https://github.com/soarsmu/BugsInPy/blob/master/framework/bin/bugsinpy-compile#L57).

To use BugsInPy correctly, you must either:

1. Configure your OS's `python` command
to point to the correct version
for the project being compiled, or
2. Install three separate 
virtual environments for the
required Python versions and
activate the appropriate 
environment 
for each project.

We recommend the second approach, which is detailed below.

1. Install `dos2unix`, a requirement for BugsInPy:

   ```Bash
   sudo apt-get update
   sudo apt-get install dos2unix
   ```

2. After installing
[Anaconda](https://www.anaconda.com/), 
create three *conda environments*
for Python 3.6, 3.7, and 3.8,
which are the versions required by 
BugsInPy projects. 
These conda environments are used
to create the *Python virtual
environments*
in the next step. 
Once you have created the 
Python virtual environments, you 
can remove these conda 
environments if desired.

   ```Bash
   conda create --name fauxpy-3.6 python=3.6
   conda create --name fauxpy-3.7 python=3.7
   conda create --name fauxpy-3.8 python=3.8
   ```

3. Use each of the *conda environments* 
created in the previous step to 
set up *Python virtual environments*.
These Python virtual environments are 
necessary to run the scripts 
generated in the `bash_script_generator`
directory at the root of this 
repository. The scripts are 
designed to work with Python
virtual environments located in your 
home directory, with 
the specific names
`bugsinpyenv36`,
`bugsinpyenv37`, 
and `bugsinpyenv38`. 
This naming convention is required 
by the bash scripts generated 
in the
`bash_script_generator` directory.

   ```Bash
   cd ~
   
   conda activate fauxpy-3.6
   python3.6 -m venv bugsinpyenv36
   conda deactivate
   
   conda activate fauxpy-3.7
   python3.7 -m venv bugsinpyenv37
   conda deactivate
   
   conda activate fauxpy-3.8
   python3.8 -m venv bugsinpyenv38
   conda deactivate
   ```

4. Create a backup of 
your `.bashrc` file in your 
home directory, naming 
it `_bashrc`. 
Some of the programs in 
BugsInPy modify 
your `.bashrc` file during 
compilation, so
our scripts require a backup version of
`.bashrc` to fix these side 
effects.

   ```
   cp ~/.bashrc ~/_bashrc
   ```

## How to Execute Tests

The tests are done on two
different version: the
previous version `$previos` and
the current version `$current`.

to do that, first clone
this repository and navigate
to the `fauxpy-test/versions` directory.

```bash
git@github.com:mohrez86/fauxpy-test.git
cd fauxpy-test
```

